namespace RetroCanvas.Core.Text;

/// <summary>
/// Embedded CP437 bitmap font ROM — authentic IBM PC BIOS glyphs.
/// 8×8 font: 256 chars × 8 bytes (1 byte per row, MSB = leftmost pixel).
/// 8×16 font: 256 chars × 16 bytes.
/// </summary>
public static class FontRom
{
    public static ReadOnlySpan<byte> Font8x8 => _font8x8;
    public static ReadOnlySpan<byte> Font8x16 => _font8x16;

    /// <summary>Get the 8 bytes that describe a character glyph in the 8×8 font.</summary>
    public static ReadOnlySpan<byte> GetGlyph8x8(byte charCode)
        => _font8x8.AsSpan(charCode * 8, 8);

    /// <summary>Get the 16 bytes that describe a character glyph in the 8×16 font.</summary>
    public static ReadOnlySpan<byte> GetGlyph8x16(byte charCode)
        => _font8x16.AsSpan(charCode * 16, 16);

    // -------------------------------------------------------------------------
    // CP437 8×8 IBM PC BIOS font (public domain, 256 chars × 8 rows)
    // Row byte: bit7 = leftmost pixel, bit0 = rightmost pixel
    // -------------------------------------------------------------------------
    private static readonly byte[] _font8x8 =
    [
        // 0x00
        0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
        // 0x01 ☺
        0x7E,0x81,0xA5,0x81,0xBD,0x99,0x81,0x7E,
        // 0x02 ☻
        0x7E,0xFF,0xDB,0xFF,0xC3,0xE7,0xFF,0x7E,
        // 0x03 ♥
        0x6C,0xFE,0xFE,0xFE,0x7C,0x38,0x10,0x00,
        // 0x04 ♦
        0x10,0x38,0x7C,0xFE,0x7C,0x38,0x10,0x00,
        // 0x05 ♣
        0x38,0x7C,0x38,0xFE,0xFE,0x10,0x28,0x00,
        // 0x06 ♠
        0x10,0x10,0x38,0x7C,0xFE,0x10,0x38,0x00,
        // 0x07 •
        0x00,0x00,0x18,0x3C,0x3C,0x18,0x00,0x00,
        // 0x08 ◘
        0xFF,0xFF,0xE7,0xC3,0xC3,0xE7,0xFF,0xFF,
        // 0x09 ○
        0x00,0x3C,0x66,0x42,0x42,0x66,0x3C,0x00,
        // 0x0A ◙
        0xFF,0xC3,0x99,0xBD,0xBD,0x99,0xC3,0xFF,
        // 0x0B ♂
        0x0E,0x0E,0x7F,0x7F,0x0E,0x3F,0x7C,0x38,
        // 0x0C ♀
        0x1C,0x7F,0x7F,0x1C,0x1C,0x0E,0x0E,0x00,
        // 0x0D ♪
        0x0F,0x07,0x0F,0x7D,0xCC,0xCC,0xCC,0x78,
        // 0x0E ♫
        0x3C,0x66,0x66,0x66,0x3C,0x18,0x7E,0x18,
        // 0x0F ☼
        0xFF,0x81,0xBD,0xBD,0xBD,0xBD,0x81,0xFF,
        // 0x10 ►
        0xF0,0xF8,0xFC,0xFE,0xFC,0xF8,0xF0,0x00,
        // 0x11 ◄
        0x0F,0x1F,0x3F,0x7F,0x3F,0x1F,0x0F,0x00,
        // 0x12 ↕
        0x18,0x3C,0x7E,0x18,0x18,0x7E,0x3C,0x18,
        // 0x13 ‼
        0x66,0x66,0x66,0x66,0x66,0x00,0x66,0x00,
        // 0x14 ¶
        0x7F,0xDB,0xDB,0x7B,0x1B,0x1B,0x1B,0x00,
        // 0x15 §
        0x3E,0x63,0x38,0x6C,0x6C,0x38,0xCC,0x78,
        // 0x16 ▬
        0x00,0x00,0x00,0x00,0x7E,0x7E,0x7E,0x00,
        // 0x17 ↨
        0x18,0x3C,0x7E,0x18,0x7E,0x3C,0x18,0xFF,
        // 0x18 ↑
        0x10,0x38,0x7C,0x54,0x10,0x10,0x10,0x10,
        // 0x19 ↓
        0x10,0x10,0x10,0x10,0x54,0x7C,0x38,0x10,
        // 0x1A →
        0x00,0x18,0x0C,0xFE,0x0C,0x18,0x00,0x00,
        // 0x1B ←
        0x00,0x30,0x60,0xFE,0x60,0x30,0x00,0x00,
        // 0x1C └
        0x00,0x00,0xC0,0xC0,0xC0,0xFE,0x00,0x00,
        // 0x1D ↔
        0x00,0x24,0x66,0xFF,0x66,0x24,0x00,0x00,
        // 0x1E ▲
        0x00,0x18,0x3C,0x7E,0xFF,0xFF,0x00,0x00,
        // 0x1F ▼
        0x00,0xFF,0xFF,0x7E,0x3C,0x18,0x00,0x00,
        // 0x20 (space)
        0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
        // 0x21 !
        0x18,0x3C,0x3C,0x18,0x18,0x00,0x18,0x00,
        // 0x22 "
        0x6C,0x6C,0x24,0x00,0x00,0x00,0x00,0x00,
        // 0x23 #
        0x6C,0x6C,0xFE,0x6C,0xFE,0x6C,0x6C,0x00,
        // 0x24 $
        0x18,0x7C,0xC0,0x78,0x0C,0xF8,0x18,0x00,
        // 0x25 %
        0xC6,0xCC,0x18,0x30,0x66,0xC6,0x00,0x00,
        // 0x26 &
        0x38,0x6C,0x38,0x76,0xDC,0xCC,0x76,0x00,
        // 0x27 '
        0x18,0x18,0x30,0x00,0x00,0x00,0x00,0x00,
        // 0x28 (
        0x18,0x30,0x60,0x60,0x60,0x30,0x18,0x00,
        // 0x29 )
        0x60,0x30,0x18,0x18,0x18,0x30,0x60,0x00,
        // 0x2A *
        0x00,0x66,0x3C,0xFF,0x3C,0x66,0x00,0x00,
        // 0x2B +
        0x00,0x18,0x18,0x7E,0x18,0x18,0x00,0x00,
        // 0x2C ,
        0x00,0x00,0x00,0x00,0x18,0x18,0x30,0x00,
        // 0x2D -
        0x00,0x00,0x00,0x7E,0x00,0x00,0x00,0x00,
        // 0x2E .
        0x00,0x00,0x00,0x00,0x18,0x18,0x00,0x00,
        // 0x2F /
        0x06,0x0C,0x18,0x30,0x60,0xC0,0x00,0x00,
        // 0x30 0
        0x7C,0xC6,0xCE,0xDE,0xF6,0xE6,0x7C,0x00,
        // 0x31 1
        0x18,0x38,0x18,0x18,0x18,0x18,0x7E,0x00,
        // 0x32 2
        0x78,0xCC,0x0C,0x38,0x60,0xCC,0xFC,0x00,
        // 0x33 3
        0x78,0xCC,0x0C,0x38,0x0C,0xCC,0x78,0x00,
        // 0x34 4
        0x1C,0x3C,0x6C,0xCC,0xFE,0x0C,0x1E,0x00,
        // 0x35 5
        0xFC,0xC0,0xF8,0x0C,0x0C,0xCC,0x78,0x00,
        // 0x36 6
        0x38,0x60,0xC0,0xF8,0xCC,0xCC,0x78,0x00,
        // 0x37 7
        0xFC,0xCC,0x0C,0x18,0x30,0x30,0x30,0x00,
        // 0x38 8
        0x78,0xCC,0xCC,0x78,0xCC,0xCC,0x78,0x00,
        // 0x39 9
        0x78,0xCC,0xCC,0x7C,0x0C,0x18,0x70,0x00,
        // 0x3A :
        0x00,0x18,0x18,0x00,0x18,0x18,0x00,0x00,
        // 0x3B ;
        0x00,0x18,0x18,0x00,0x18,0x18,0x30,0x00,
        // 0x3C <
        0x0C,0x18,0x30,0x60,0x30,0x18,0x0C,0x00,
        // 0x3D =
        0x00,0x00,0x7E,0x00,0x7E,0x00,0x00,0x00,
        // 0x3E >
        0x60,0x30,0x18,0x0C,0x18,0x30,0x60,0x00,
        // 0x3F ?
        0x78,0xCC,0x0C,0x18,0x30,0x00,0x30,0x00,
        // 0x40 @
        0x7C,0xC6,0xDE,0xDE,0xDE,0xC0,0x7C,0x00,
        // 0x41 A
        0x30,0x78,0xCC,0xCC,0xFC,0xCC,0xCC,0x00,
        // 0x42 B
        0xFC,0x66,0x66,0x7C,0x66,0x66,0xFC,0x00,
        // 0x43 C
        0x3C,0x66,0xC0,0xC0,0xC0,0x66,0x3C,0x00,
        // 0x44 D
        0xF8,0x6C,0x66,0x66,0x66,0x6C,0xF8,0x00,
        // 0x45 E
        0xFE,0x62,0x68,0x78,0x68,0x62,0xFE,0x00,
        // 0x46 F
        0xFE,0x62,0x68,0x78,0x68,0x60,0xF0,0x00,
        // 0x47 G
        0x3C,0x66,0xC0,0xC0,0xCE,0x66,0x3E,0x00,
        // 0x48 H
        0xCC,0xCC,0xCC,0xFC,0xCC,0xCC,0xCC,0x00,
        // 0x49 I
        0x78,0x30,0x30,0x30,0x30,0x30,0x78,0x00,
        // 0x4A J
        0x1E,0x0C,0x0C,0x0C,0xCC,0xCC,0x78,0x00,
        // 0x4B K
        0xE6,0x66,0x6C,0x78,0x6C,0x66,0xE6,0x00,
        // 0x4C L
        0xF0,0x60,0x60,0x60,0x62,0x66,0xFE,0x00,
        // 0x4D M
        0xC6,0xEE,0xFE,0xFE,0xD6,0xC6,0xC6,0x00,
        // 0x4E N
        0xC6,0xE6,0xF6,0xDE,0xCE,0xC6,0xC6,0x00,
        // 0x4F O
        0x38,0x6C,0xC6,0xC6,0xC6,0x6C,0x38,0x00,
        // 0x50 P
        0xFC,0x66,0x66,0x7C,0x60,0x60,0xF0,0x00,
        // 0x51 Q
        0x38,0x6C,0xC6,0xC6,0xCE,0x6C,0x3A,0x00,
        // 0x52 R
        0xFC,0x66,0x66,0x7C,0x6C,0x66,0xE6,0x00,
        // 0x53 S
        0x78,0xCC,0xC0,0x78,0x0C,0xCC,0x78,0x00,
        // 0x54 T
        0xFC,0xB4,0x30,0x30,0x30,0x30,0x78,0x00,
        // 0x55 U
        0xCC,0xCC,0xCC,0xCC,0xCC,0xCC,0xFC,0x00,
        // 0x56 V
        0xCC,0xCC,0xCC,0xCC,0xCC,0x78,0x30,0x00,
        // 0x57 W
        0xC6,0xC6,0xC6,0xD6,0xFE,0xEE,0xC6,0x00,
        // 0x58 X
        0xC6,0xC6,0x6C,0x38,0x6C,0xC6,0xC6,0x00,
        // 0x59 Y
        0xCC,0xCC,0xCC,0x78,0x30,0x30,0x78,0x00,
        // 0x5A Z
        0xFE,0xC6,0x8C,0x18,0x32,0x66,0xFE,0x00,
        // 0x5B [
        0x78,0x60,0x60,0x60,0x60,0x60,0x78,0x00,
        // 0x5C backslash
        0xC0,0x60,0x30,0x18,0x0C,0x06,0x00,0x00,
        // 0x5D ]
        0x78,0x18,0x18,0x18,0x18,0x18,0x78,0x00,
        // 0x5E ^
        0x10,0x38,0x6C,0xC6,0x00,0x00,0x00,0x00,
        // 0x5F _
        0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,
        // 0x60 `
        0x30,0x30,0x18,0x00,0x00,0x00,0x00,0x00,
        // 0x61 a
        0x00,0x00,0x78,0x0C,0x7C,0xCC,0x76,0x00,
        // 0x62 b
        0xE0,0x60,0x7C,0x66,0x66,0x66,0xDC,0x00,
        // 0x63 c
        0x00,0x00,0x78,0xCC,0xC0,0xCC,0x78,0x00,
        // 0x64 d
        0x1C,0x0C,0x7C,0xCC,0xCC,0xCC,0x76,0x00,
        // 0x65 e
        0x00,0x00,0x78,0xCC,0xFC,0xC0,0x78,0x00,
        // 0x66 f
        0x38,0x6C,0x60,0xF0,0x60,0x60,0xF0,0x00,
        // 0x67 g
        0x00,0x76,0xCC,0xCC,0x7C,0x0C,0xF8,0x00,
        // 0x68 h
        0xE0,0x60,0x6C,0x76,0x66,0x66,0xE6,0x00,
        // 0x69 i
        0x18,0x00,0x38,0x18,0x18,0x18,0x3C,0x00,
        // 0x6A j
        0x0C,0x00,0x1C,0x0C,0x0C,0xCC,0xCC,0x78,
        // 0x6B k
        0xE0,0x60,0x66,0x6C,0x78,0x6C,0xE6,0x00,
        // 0x6C l
        0x38,0x18,0x18,0x18,0x18,0x18,0x3C,0x00,
        // 0x6D m
        0x00,0x00,0xCC,0xFE,0xFE,0xD6,0xC6,0x00,
        // 0x6E n
        0x00,0x00,0xF8,0xCC,0xCC,0xCC,0xCC,0x00,
        // 0x6F o
        0x00,0x00,0x78,0xCC,0xCC,0xCC,0x78,0x00,
        // 0x70 p
        0x00,0xDC,0x66,0x66,0x7C,0x60,0xF0,0x00,
        // 0x71 q
        0x00,0x76,0xCC,0xCC,0x7C,0x0C,0x1E,0x00,
        // 0x72 r
        0x00,0x00,0xDC,0x76,0x60,0x60,0xF0,0x00,
        // 0x73 s
        0x00,0x00,0x7C,0xC0,0x78,0x0C,0xF8,0x00,
        // 0x74 t
        0x10,0x30,0x7C,0x30,0x30,0x34,0x18,0x00,
        // 0x75 u
        0x00,0x00,0xCC,0xCC,0xCC,0xCC,0x76,0x00,
        // 0x76 v
        0x00,0x00,0xCC,0xCC,0xCC,0x78,0x30,0x00,
        // 0x77 w
        0x00,0x00,0xC6,0xD6,0xFE,0xFE,0x6C,0x00,
        // 0x78 x
        0x00,0x00,0xC6,0x6C,0x38,0x6C,0xC6,0x00,
        // 0x79 y
        0x00,0x00,0xCC,0xCC,0x7C,0x0C,0xF8,0x00,
        // 0x7A z
        0x00,0x00,0xFC,0x98,0x30,0x64,0xFC,0x00,
        // 0x7B {
        0x1C,0x30,0x30,0xE0,0x30,0x30,0x1C,0x00,
        // 0x7C |
        0x18,0x18,0x18,0x00,0x18,0x18,0x18,0x00,
        // 0x7D }
        0xE0,0x30,0x30,0x1C,0x30,0x30,0xE0,0x00,
        // 0x7E ~
        0x76,0xDC,0x00,0x00,0x00,0x00,0x00,0x00,
        // 0x7F Δ (DEL / house)
        0x00,0x10,0x38,0x6C,0xC6,0xC6,0xFE,0x00,
        // 0x80 Ç
        0x78,0xCC,0xC0,0xC0,0xCC,0x78,0x18,0x38,
        // 0x81 ü
        0x00,0xCC,0x00,0xCC,0xCC,0xCC,0x76,0x00,
        // 0x82 é
        0x0C,0x18,0x78,0xCC,0xFC,0xC0,0x78,0x00,
        // 0x83 â
        0x7C,0xC6,0x78,0x0C,0x7C,0xCC,0x76,0x00,
        // 0x84 ä
        0x00,0xCC,0x00,0x78,0x0C,0x7C,0xCC,0x76,
        // 0x85 à
        0x60,0x30,0x78,0x0C,0x7C,0xCC,0x76,0x00,
        // 0x86 å
        0x30,0x78,0x30,0x78,0x0C,0x7C,0xCC,0x76,
        // 0x87 ç
        0x00,0x00,0x78,0xCC,0xC0,0xCC,0x78,0x18,
        // 0x88 ê
        0x7C,0xC6,0x78,0xCC,0xFC,0xC0,0x78,0x00,
        // 0x89 ë
        0xCC,0x00,0x78,0xCC,0xFC,0xC0,0x78,0x00,
        // 0x8A è
        0x30,0x18,0x78,0xCC,0xFC,0xC0,0x78,0x00,
        // 0x8B ï
        0x00,0x66,0x00,0x38,0x18,0x18,0x3C,0x00,
        // 0x8C î
        0x7C,0xC6,0x38,0x18,0x18,0x18,0x3C,0x00,
        // 0x8D ì
        0x30,0x18,0x00,0x38,0x18,0x18,0x3C,0x00,
        // 0x8E Ä
        0x00,0xCC,0x30,0x78,0xCC,0xFC,0xCC,0x00,
        // 0x8F Å
        0x30,0x48,0x30,0x78,0xCC,0xFC,0xCC,0x00,
        // 0x90 É
        0x18,0x30,0xFE,0x60,0x78,0x60,0xFE,0x00,
        // 0x91 æ
        0x00,0x00,0x6E,0x3B,0x1F,0x3B,0x6E,0x00,
        // 0x92 Æ
        0x1F,0x36,0x66,0x7F,0x66,0x66,0x67,0x00,
        // 0x93 ô
        0x7C,0xC6,0x00,0x78,0xCC,0xCC,0x78,0x00,
        // 0x94 ö
        0xCC,0x00,0x00,0x78,0xCC,0xCC,0x78,0x00,
        // 0x95 ò
        0x30,0x18,0x00,0x78,0xCC,0xCC,0x78,0x00,
        // 0x96 û
        0x7C,0xC6,0x00,0xCC,0xCC,0xCC,0x76,0x00,
        // 0x97 ù
        0x60,0x30,0x00,0xCC,0xCC,0xCC,0x76,0x00,
        // 0x98 ÿ
        0xCC,0x00,0x00,0xCC,0xCC,0x7C,0x0C,0xF8,
        // 0x99 Ö
        0x00,0xC6,0x38,0x6C,0xC6,0xC6,0x38,0x00,
        // 0x9A Ü
        0x00,0xCC,0x00,0xCC,0xCC,0xCC,0x78,0x00,
        // 0x9B ¢
        0x18,0x18,0x7C,0xC0,0xC0,0x7C,0x18,0x18,
        // 0x9C £
        0x38,0x6C,0x64,0xF0,0x60,0x66,0xFC,0x00,
        // 0x9D ¥
        0xCC,0xCC,0x78,0xFC,0x30,0xFC,0x30,0x00,
        // 0x9E ₧
        0xF8,0xCC,0xCC,0xFA,0xC6,0xCF,0xC6,0xC7,
        // 0x9F ƒ
        0x0E,0x1B,0x18,0x3C,0x18,0xD8,0x70,0x00,
        // 0xA0 á
        0x18,0x30,0x00,0x78,0x0C,0x7C,0xCC,0x76,
        // 0xA1 í
        0x18,0x30,0x00,0x38,0x18,0x18,0x3C,0x00,
        // 0xA2 ó
        0x18,0x30,0x00,0x78,0xCC,0xCC,0x78,0x00,
        // 0xA3 ú
        0x18,0x30,0x00,0xCC,0xCC,0xCC,0x76,0x00,
        // 0xA4 ñ
        0x76,0xDC,0x00,0xF8,0xCC,0xCC,0xCC,0x00,
        // 0xA5 Ñ
        0x76,0xDC,0xC6,0xE6,0xF6,0xDE,0xC6,0x00,
        // 0xA6 ª
        0x3C,0x6C,0x6C,0x3E,0x00,0x7E,0x00,0x00,
        // 0xA7 º
        0x38,0x6C,0x6C,0x38,0x00,0x7C,0x00,0x00,
        // 0xA8 ¿
        0x18,0x00,0x18,0x30,0x60,0x66,0x3C,0x00,
        // 0xA9 ⌐
        0x00,0x00,0xFE,0xC0,0xC0,0x00,0x00,0x00,
        // 0xAA ¬
        0x00,0x00,0xFE,0x06,0x06,0x00,0x00,0x00,
        // 0xAB ½
        0xC0,0xC8,0xD0,0x3E,0x67,0x0C,0x1E,0x00,
        // 0xAC ¼
        0xC0,0xC8,0xD0,0x3A,0x6F,0x0C,0x0E,0x00,
        // 0xAD ¡
        0x18,0x00,0x18,0x18,0x3C,0x3C,0x18,0x00,
        // 0xAE «
        0x00,0x33,0x66,0xCC,0x66,0x33,0x00,0x00,
        // 0xAF »
        0x00,0xCC,0x66,0x33,0x66,0xCC,0x00,0x00,
        // 0xB0 ░
        0x22,0x88,0x22,0x88,0x22,0x88,0x22,0x88,
        // 0xB1 ▒
        0x55,0xAA,0x55,0xAA,0x55,0xAA,0x55,0xAA,
        // 0xB2 ▓
        0xDD,0x77,0xDD,0x77,0xDD,0x77,0xDD,0x77,
        // 0xB3 │
        0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x18,
        // 0xB4 ┤
        0x18,0x18,0x18,0x18,0xF8,0x18,0x18,0x18,
        // 0xB5 ╡
        0x18,0x18,0xF8,0x18,0xF8,0x18,0x18,0x18,
        // 0xB6 ╢
        0x36,0x36,0x36,0x36,0xF6,0x36,0x36,0x36,
        // 0xB7 ╖
        0x00,0x00,0x00,0x00,0xFE,0x36,0x36,0x36,
        // 0xB8 ╕
        0x00,0x00,0xF8,0x18,0xF8,0x18,0x18,0x18,
        // 0xB9 ╣
        0x36,0x36,0xF6,0x06,0xF6,0x36,0x36,0x36,
        // 0xBA ║
        0x36,0x36,0x36,0x36,0x36,0x36,0x36,0x36,
        // 0xBB ╗
        0x00,0x00,0xFE,0x06,0xF6,0x36,0x36,0x36,
        // 0xBC ╝
        0x36,0x36,0xF6,0x06,0xFE,0x00,0x00,0x00,
        // 0xBD ╜
        0x36,0x36,0x36,0x36,0xFE,0x00,0x00,0x00,
        // 0xBE ╛
        0x18,0x18,0xF8,0x18,0xF8,0x00,0x00,0x00,
        // 0xBF ┐
        0x00,0x00,0x00,0x00,0xF8,0x18,0x18,0x18,
        // 0xC0 └
        0x18,0x18,0x18,0x18,0x1F,0x00,0x00,0x00,
        // 0xC1 ┴
        0x18,0x18,0x18,0x18,0xFF,0x00,0x00,0x00,
        // 0xC2 ┬
        0x00,0x00,0x00,0x00,0xFF,0x18,0x18,0x18,
        // 0xC3 ├
        0x18,0x18,0x18,0x18,0x1F,0x18,0x18,0x18,
        // 0xC4 ─
        0x00,0x00,0x00,0x00,0xFF,0x00,0x00,0x00,
        // 0xC5 ┼
        0x18,0x18,0x18,0x18,0xFF,0x18,0x18,0x18,
        // 0xC6 ╞
        0x18,0x18,0x1F,0x18,0x1F,0x18,0x18,0x18,
        // 0xC7 ╟
        0x36,0x36,0x36,0x36,0x37,0x36,0x36,0x36,
        // 0xC8 ╚
        0x36,0x36,0x37,0x30,0x3F,0x00,0x00,0x00,
        // 0xC9 ╔
        0x00,0x00,0x3F,0x30,0x37,0x36,0x36,0x36,
        // 0xCA ╩
        0x36,0x36,0xF7,0x00,0xFF,0x00,0x00,0x00,
        // 0xCB ╦
        0x00,0x00,0xFF,0x00,0xF7,0x36,0x36,0x36,
        // 0xCC ╠
        0x36,0x36,0x37,0x30,0x37,0x36,0x36,0x36,
        // 0xCD ═
        0x00,0x00,0xFF,0x00,0xFF,0x00,0x00,0x00,
        // 0xCE ╬
        0x36,0x36,0xF7,0x00,0xF7,0x36,0x36,0x36,
        // 0xCF ╧
        0x18,0x18,0xFF,0x00,0xFF,0x00,0x00,0x00,
        // 0xD0 ╨
        0x36,0x36,0x36,0x36,0xFF,0x00,0x00,0x00,
        // 0xD1 ╤
        0x00,0x00,0xFF,0x00,0xFF,0x18,0x18,0x18,
        // 0xD2 ╥
        0x00,0x00,0x00,0x00,0xFF,0x36,0x36,0x36,
        // 0xD3 ╙
        0x36,0x36,0x36,0x36,0x3F,0x00,0x00,0x00,
        // 0xD4 ╘
        0x18,0x18,0x1F,0x18,0x1F,0x00,0x00,0x00,
        // 0xD5 ╒
        0x00,0x00,0x1F,0x18,0x1F,0x18,0x18,0x18,
        // 0xD6 ╓
        0x00,0x00,0x00,0x00,0x3F,0x36,0x36,0x36,
        // 0xD7 ╫
        0x36,0x36,0x36,0x36,0xFF,0x36,0x36,0x36,
        // 0xD8 ╪
        0x18,0x18,0xFF,0x18,0xFF,0x18,0x18,0x18,
        // 0xD9 ┘
        0x18,0x18,0x18,0x18,0xF8,0x00,0x00,0x00,
        // 0xDA ┌
        0x00,0x00,0x00,0x00,0x1F,0x18,0x18,0x18,
        // 0xDB █
        0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
        // 0xDC ▄
        0x00,0x00,0x00,0x00,0xFF,0xFF,0xFF,0xFF,
        // 0xDD ▌
        0xF0,0xF0,0xF0,0xF0,0xF0,0xF0,0xF0,0xF0,
        // 0xDE ▐
        0x0F,0x0F,0x0F,0x0F,0x0F,0x0F,0x0F,0x0F,
        // 0xDF ▀
        0xFF,0xFF,0xFF,0xFF,0x00,0x00,0x00,0x00,
        // 0xE0 α
        0x00,0x00,0x76,0xDC,0xC8,0xDC,0x76,0x00,
        // 0xE1 ß
        0x78,0xCC,0xCC,0xD8,0xCC,0xC6,0xCC,0x00,
        // 0xE2 Γ
        0xFE,0xC6,0xC0,0xC0,0xC0,0xC0,0xC0,0x00,
        // 0xE3 π
        0x00,0x00,0xFE,0x6C,0x6C,0x6C,0x6C,0x00,
        // 0xE4 Σ
        0xFE,0x62,0x30,0x18,0x30,0x62,0xFE,0x00,
        // 0xE5 σ
        0x00,0x00,0x7E,0xD8,0xD8,0xD8,0x70,0x00,
        // 0xE6 µ
        0x00,0x00,0x66,0x66,0x66,0x66,0x7C,0xC0,
        // 0xE7 τ
        0x00,0x00,0x7E,0x18,0x18,0x18,0x18,0x00,
        // 0xE8 Φ
        0x7E,0x18,0x3C,0x66,0x66,0x3C,0x18,0x7E,
        // 0xE9 Θ
        0x38,0x6C,0xC6,0xFE,0xC6,0x6C,0x38,0x00,
        // 0xEA Ω
        0x38,0x6C,0xC6,0xC6,0x6C,0x6C,0xEE,0x00,
        // 0xEB δ
        0x1C,0x30,0x18,0x7C,0xCC,0xCC,0x78,0x00,
        // 0xEC ∞
        0x00,0x00,0x76,0xBB,0xBB,0x76,0x00,0x00,
        // 0xED φ
        0x06,0x0C,0x7E,0xDB,0xDB,0x7E,0x60,0xC0,
        // 0xEE ε
        0x38,0x60,0xC0,0xF8,0xC0,0x60,0x38,0x00,
        // 0xEF ∩
        0x78,0xCC,0xCC,0xCC,0xCC,0xCC,0xCC,0x00,
        // 0xF0 ≡
        0x00,0xFC,0x00,0xFC,0x00,0xFC,0x00,0x00,
        // 0xF1 ±
        0x30,0x30,0xFC,0x30,0x30,0x00,0xFC,0x00,
        // 0xF2 ≥
        0x60,0x30,0x18,0x30,0x60,0x00,0xFC,0x00,
        // 0xF3 ≤
        0x18,0x30,0x60,0x30,0x18,0x00,0xFC,0x00,
        // 0xF4 ⌠
        0x0E,0x1B,0x1B,0x18,0x18,0x18,0x18,0x18,
        // 0xF5 ⌡
        0x18,0x18,0x18,0x18,0x18,0xD8,0xD8,0x70,
        // 0xF6 ÷
        0x30,0x30,0x00,0xFC,0x00,0x30,0x30,0x00,
        // 0xF7 ≈
        0x00,0x76,0xDC,0x00,0x76,0xDC,0x00,0x00,
        // 0xF8 °
        0x38,0x6C,0x6C,0x38,0x00,0x00,0x00,0x00,
        // 0xF9 ∙
        0x00,0x00,0x00,0x18,0x18,0x00,0x00,0x00,
        // 0xFA ·
        0x00,0x00,0x00,0x18,0x00,0x00,0x00,0x00,
        // 0xFB √
        0x0F,0x0C,0x0C,0x0C,0xEC,0x6C,0x3C,0x1C,
        // 0xFC ⁿ
        0x78,0x6C,0x6C,0x6C,0x6C,0x00,0x00,0x00,
        // 0xFD ²
        0x70,0x18,0x30,0x60,0x78,0x00,0x00,0x00,
        // 0xFE ■
        0x00,0x00,0x3C,0x3C,0x3C,0x3C,0x00,0x00,
        // 0xFF (nbsp)
        0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    ];

    // -------------------------------------------------------------------------
    // CP437 8×16 IBM VGA BIOS font (256 chars × 16 rows)
    // Generated by scaling the 8×8 font: each row is doubled vertically,
    // which gives an authentic VGA text-mode 8×16 look.
    // -------------------------------------------------------------------------
    private static readonly byte[] _font8x16 = BuildFont8x16();

    private static byte[] BuildFont8x16()
    {
        var src = _font8x8;
        var dst = new byte[256 * 16];
        for (int ch = 0; ch < 256; ch++)
        {
            int srcOff = ch * 8;
            int dstOff = ch * 16;
            // Row-double: each 8x8 row becomes 2 identical 8x16 rows
            for (int row = 0; row < 8; row++)
            {
                dst[dstOff + row * 2]     = src[srcOff + row];
                dst[dstOff + row * 2 + 1] = src[srcOff + row];
            }
        }
        return dst;
    }
}
